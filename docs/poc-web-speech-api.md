# Web Speech API POC計画書

## 1. POC概要

### 1.1 目的
Web Speech APIを使用して、Chrome拡張機能による動画音声の文字起こし機能の技術的実現可能性を検証する。

### 1.2 POCスコープ
- **対象技術**: Web Speech API（Chrome標準）
- **検証期間**: 1週間
- **検証環境**: Google Chrome最新版
- **対象サイト**: YouTube（検証用）

### 1.3 成功基準
- [ ] アクティブタブの音声キャプチャが可能
- [ ] リアルタイムでの音声認識が動作
- [ ] 10分以上の連続録音・認識が可能
- [ ] 日本語・英語での音声認識精度が実用レベル（70%以上）
- [ ] 文字起こし結果をテキストファイルとして保存可能

## 2. 技術検証項目

### 2.1 音声キャプチャ機能
- **検証内容**: `chrome.tabCapture` APIを使用したタブ音声の取得
- **実装方法**: MediaStreamの取得と音声データの処理
- **確認項目**:
  - [ ] アクティブタブの音声が取得できる
  - [ ] 音質が文字起こしに適している
  - [ ] 長時間キャプチャでメモリリークが発生しない

### 2.2 Web Speech API音声認識
- **検証内容**: `SpeechRecognition` APIを使用したリアルタイム音声認識
- **実装方法**: MediaStreamをSpeechRecognitionに接続
- **確認項目**:
  - [ ] リアルタイムでの音声認識が動作
  - [ ] 連続認識（continuous: true）が安定動作
  - [ ] 言語設定（日本語・英語）が正しく機能
  - [ ] 認識結果の信頼度スコアが取得可能

### 2.3 Chrome拡張機能としての統合
- **検証内容**: Manifest V3での拡張機能実装
- **実装方法**: background script、content script、popupの連携
- **確認項目**:
  - [ ] 必要な権限（tabs, activeTab, tabCapture）が正しく動作
  - [ ] ツールバーアイコンからの操作が可能
  - [ ] 録音状態の視覚的フィードバックが表示される

### 2.4 データ保存機能
- **検証内容**: 文字起こし結果のローカル保存
- **実装方法**: Chrome Storage API または File System Access API
- **確認項目**:
  - [ ] 文字起こし結果をテキストファイルとして保存
  - [ ] ファイル名の自動生成（タイムスタンプ + タイトル）
  - [ ] ダウンロードフォルダへの保存が可能

## 3. 実装計画

### 3.1 Day 1-2: 基本構造の構築
- **目標**: Chrome拡張機能の基本骨格を作成
- **成果物**:
  - `manifest.json`（Manifest V3）
  - `background.js`（Service Worker）
  - `popup.html/js`（UI）
  - `content.js`（コンテンツスクリプト）

### 3.2 Day 3-4: 音声キャプチャ機能の実装
- **目標**: タブ音声の取得機能を実装
- **成果物**:
  - tabCapture APIを使用した音声取得機能
  - MediaStreamの処理機能
  - 音声品質の確認機能

### 3.3 Day 5-6: 音声認識機能の実装
- **目標**: Web Speech APIによるリアルタイム音声認識
- **成果物**:
  - SpeechRecognition APIの統合
  - リアルタイム文字起こし表示
  - 言語設定機能

### 3.4 Day 7: 統合テストと評価
- **目標**: 全機能の統合テストと精度評価
- **成果物**:
  - 動作確認レポート
  - 精度測定結果
  - 次ステップへの推奨事項

## 4. 技術仕様

### 4.1 Chrome拡張機能構成
```
manifest.json           # Manifest V3設定
background.js           # Service Worker（メイン処理）
popup/
  ├── popup.html        # ポップアップUI
  ├── popup.js          # ポップアップ制御
  └── popup.css         # スタイル
content.js              # コンテンツスクリプト
utils/
  ├── audioCapture.js   # 音声キャプチャ機能
  ├── speechRecognition.js # 音声認識機能
  └── fileManager.js    # ファイル保存機能
```

### 4.2 必要な権限
```json
{
  "permissions": [
    "tabs",
    "activeTab", 
    "tabCapture",
    "storage",
    "downloads"
  ]
}
```

### 4.3 Web Speech API設定
- **言語**: `ja-JP`（日本語）、`en-US`（英語）
- **連続認識**: `continuous: true`
- **暫定結果**: `interimResults: true`
- **最大代替候補**: `maxAlternatives: 1`

## 5. 検証シナリオ

### 5.1 基本動作テスト
1. **短時間動画テスト**（1-3分）
   - YouTube教育動画での文字起こし
   - 日本語・英語それぞれでテスト
   - 認識精度の測定

2. **中時間動画テスト**（10-15分）
   - 連続録音・認識の安定性確認
   - メモリ使用量の監視
   - エラーハンドリングの確認

3. **異なる音声条件でのテスト**
   - クリアな音声（講義動画）
   - 雑音混じりの音声
   - 複数話者の音声

### 5.2 性能評価指標
- **精度**: 手動でのテキスト比較による精度測定
- **レスポンス**: 音声開始から文字表示までの遅延時間
- **安定性**: 連続動作時間とエラー発生率
- **リソース**: CPU・メモリ使用量

## 6. 想定される課題と対策

### 6.1 Web Speech APIの制限
- **課題**: ネットワーク依存、精度の限界
- **対策**: オフライン時のエラーハンドリング、精度向上のための前処理

### 6.2 音声キャプチャの技術的課題
- **課題**: タブ音声の取得権限、音質の問題
- **対策**: 適切な権限要求、音声品質の最適化

### 6.3 長時間録音時の安定性
- **課題**: メモリリーク、接続切断
- **対策**: 定期的なリソース解放、再接続機能

## 7. POC完了後の評価項目

### 7.1 技術的評価
- [ ] Web Speech APIの実用性評価
- [ ] Chrome拡張機能としての実装可能性
- [ ] 性能・安定性の評価
- [ ] セキュリティ面での考慮事項

### 7.2 次ステップの判断
- **継続決定基準**: 精度70%以上、10分以上安定動作
- **代替案検討**: Google Speech-to-Text API、OpenAI Whisper API
- **追加機能検討**: Google Drive連携、UI改善

## 8. 成果物

### 8.1 コード成果物
- 動作可能なChrome拡張機能（POC版）
- 各機能モジュールのソースコード
- 設定ファイル・マニフェスト

### 8.2 ドキュメント成果物
- 技術検証レポート
- 精度測定結果
- 課題・制限事項まとめ
- 本格実装への推奨事項

## 9. スケジュール

| 日程 | 作業内容 | 成果物 |
|------|----------|--------|
| Day 1 | 開発環境構築、基本構造作成 | manifest.json, 基本ファイル |
| Day 2 | UI作成、権限設定 | popup UI, 権限確認 |
| Day 3 | 音声キャプチャ実装 | tabCapture機能 |
| Day 4 | 音声キャプチャ最適化 | 音声品質改善 |
| Day 5 | Web Speech API統合 | リアルタイム認識 |
| Day 6 | ファイル保存機能 | 保存機能完成 |
| Day 7 | 統合テスト・評価 | 検証レポート |

---

**作成日**: 2025年6月3日  
**作成者**: 開発チーム  
**レビュー予定**: POC完了後（6月10日予定）
